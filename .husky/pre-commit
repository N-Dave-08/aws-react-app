#!/bin/sh
echo "Running Biome on staged files..."

# Get list of staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# Process JS/TS files
JS_FILES=$(echo "$STAGED_FILES" | grep -E '\.(js|jsx|ts|tsx)$' || true)
if [ -n "$JS_FILES" ]; then
    echo "Processing JS/TS files: $JS_FILES"
    echo "$JS_FILES" | xargs -r npx biome format --write || true
    echo "$JS_FILES" | xargs -r npx biome lint || true
fi

# Process other files
OTHER_FILES=$(echo "$STAGED_FILES" | grep -E '\.(json|css|md)$' || true)
if [ -n "$OTHER_FILES" ]; then
    echo "Processing other files: $OTHER_FILES"
    echo "$OTHER_FILES" | xargs -r npx biome format --write || true
fi

echo "Biome completed successfully!"